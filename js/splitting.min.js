!function(b,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define(a):b.Splitting=a()}(this,function(){"use strict";var f=document,s=f.createTextNode.bind(f);function t(a,b,c){a.style.setProperty(b,c)}function u(a,b){return a.appendChild(b)}function v(d,b,c,e){var a=f.createElement("span");return b&&(a.className=b),c&&(e||a.setAttribute("data-"+b,c),a.textContent=c),d&&u(d,a)||a}function w(a,b){return a.getAttribute("data-"+b)}function x(a,b){return a&&0!=a.length?a.nodeName?[a]:[].slice.call(a[0].nodeName?a:(b||f).querySelectorAll(a)):[]}function y(a){for(var b=[];a--;)b[a]=[];return b}function z(a,b){a&&a.some(b)}function A(a){return function(b){return a[b]}}var B={};function b(a,b,c,d){return{by:a,depends:b,key:c,split:d}}function a(a){B[a.by]=a}function C(a,f,g,c,h){a.normalize();var b=[],d=document.createDocumentFragment();c&&b.push(a.previousSibling);var e=[];return x(a.childNodes).some(function(a){if(!a.tagName||a.hasChildNodes()){if(a.childNodes&&a.childNodes.length)return e.push(a),void b.push.apply(b,C(a,f,g,c,h));var i=a.wholeText||"",j=i.trim();j.length&&(" "===i[0]&&e.push(s(" ")),z(j.split(g),function(c,g){g&&h&&e.push(v(d,"whitespace"," ",h));var a=v(d,f,c);b.push(a),e.push(a)})," "===i[i.length-1]&&e.push(s(" ")))}else e.push(a)}),z(e,function(a){u(d,a)}),a.innerHTML="",u(a,d),b}var c="words",g=b(c,0,"word",function(a){return C(a,"word",/\s+/,0,1)}),h="chars",i=b(h,[c],"char",function(d,e,a){var b=[];return z(a[c],function(a,c){b.push.apply(b,C(a,"char","",e.whitespace&&c))}),b});function d(a){var b=(a=a||{}).key;return x(a.target||"[data-splitting]").map(function(c){var f,d=c["\u{1F34C}"];if(!a.force&&d)return d;d=c["\u{1F34C}"]={el:c};var e=(function e(b,f,a){var c=a.indexOf(b);if(-1==c)a.unshift(b),z(B[b].depends,function(c){e(c,b,a)});else{var d=a.indexOf(0);a.splice(c,1),a.splice(d,0,b)}return a})(a.by||w(c,"splitting")||h,0,[]).map(A(B)),g=function(a,b){for(var c in b)a[c]=b[c];return a}({},a);return z(e,function(a){if(a.split){var e,f,h,l,i=a.by,j=(b?"-"+b:"")+a.key,k=a.split(c,g,d);j&&(e=c,l=(h="--"+j)+"-index",z(f=k,function(a,b){Array.isArray(a)?z(a,function(a){t(a,l,b)}):t(a,l,b)}),t(e,h+"-total",f.length)),d[i]=k,c.classList.add(i)}}),c.classList.add("splitting"),d})}function D(a,c,e){var d=x(c.matching||a.children,a),b={};return z(d,function(a){var c=Math.round(a[e]);(b[c]||(b[c]=[])).push(a)}),Object.keys(b).map(Number).sort(E).map(A(b))}function E(a,b){return a-b}d.html=function(a){var b=(a=a||{}).target=v();return b.innerHTML=a.content,d(a),b.outerHTML},d.add=a;var j=b("lines",[c],"line",function(a,d,b){return D(a,{matching:b[c]},"offsetTop")}),k=b("items",0,"item",function(a,b){return x(b.matching||a.children,a)}),l=b("rows",0,"row",function(a,b){return D(a,b,"offsetTop")}),m=b("cols",0,"col",function(a,b){return D(a,b,"offsetLeft")}),n=b("grid",["rows","cols"]),e="layout",o=b(e,0,0,function(b,a){var g=a.rows=+(a.rows||w(b,"rows")||1),h=a.columns=+(a.columns||w(b,"columns")||1);if(a.image=a.image||w(b,"image")||b.currentSrc||b.src,a.image){var c=x("img",b)[0];a.image=c&&(c.currentSrc||c.src)}a.image&&t(b,"background-image","url("+a.image+")");for(var i=g*h,d=[],e=v(0,"cell-grid");i--;){var f=v(e,"cell");v(f,"cell-inner"),d.push(f)}return u(b,e),d}),p=b("cellRows",[e],"row",function(f,a,b){var c=a.rows,d=y(c);return z(b[e],function(a,b,e){d[Math.floor(b/(e.length/c))].push(a)}),d}),q=b("cellColumns",[e],"col",function(f,a,b){var c=a.columns,d=y(c);return z(b[e],function(a,b){d[b%c].push(a)}),d}),r=b("cells",["cellRows","cellColumns"],"cell",function(b,c,a){return a[e]});return a(g),a(i),a(j),a(k),a(l),a(m),a(n),a(o),a(p),a(q),a(r),d})